// Underscore.date
//
// (c) 2011 Tim Wood
// Underscore.date is freely distributable under the terms of the MIT license.
//
// Version 0.1.0

(function(){function m(a){return typeof a=="undefined"?b.dateNow():a instanceof Date?a:new Date(a)}function l(a,b){b=b||1,a=h[a]||a;return a.replace(/%d/i,b)}function k(a,b){var c=a+"";while(c.length<b)c="0"+c;return c}function j(a){return d[a]?d[a]():a}function i(a){return(a/10|0)===1?"th":a%10===1?"st":a%10===2?"nd":a%10===3?"rd":"th"}var a=this,b,c,d,e=/\\?([a-z])/gi,f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],g=["January","February","March","April","May","June","July","August","September","October","November","December"],h={future:"in %s",past:"%s ago",ss:"less than a minute",m:"about a minute",mm:"%d minutes",h:"about an hour",hh:"about %d hours",d:"a day",dd:"%d days",n:"about a month",nn:"%d months",y:"about a year",yy:"%d years"};d={j:function(){return c.getDate()},d:function(){return k(d.j(),2)},S:function(){return i(d.j())},l:function(){return f[d.w()]},D:function(){return d.l().slice(0,3)},w:function(){return c.getDay()},N:function(){return d.w()||7},z:function(){var a=new Date(d.Y(),d.n()-1,d.j()),b=new Date(d.Y(),0,1);return(a-b)/864e5+.5|0},W:function(){var a=new Date(d.Y(),d.n()-1,d.j()-d.N()+4),b=new Date(a.getFullYear(),0,4);return k((a-b)/864e5/7+1.5|0,2)},n:function(){return c.getMonth()+1},m:function(){return k(d.n(),2)},F:function(){return g[d.n()-1]},M:function(){return d.F().slice(0,3)},t:function(){return(new Date(d.Y(),d.n(),0)).getDate()},L:function(){return(new Date(d.Y(),1,29)).getMonth()===1|0},Y:function(){return c.getFullYear()},y:function(){return(d.Y()+"").slice(-2)},a:function(){return c.getHours()>11?"pm":"am"},A:function(){return d.a().toUpperCase()},B:function(){var a=c.getUTCHours()*3600,b=c.getUTCMinutes()*60,d=c.getUTCSeconds();return k((a+b+d+3600)/86.4%1e3|0,3)},g:function(){return d.G()%12||12},h:function(){return k(d.g(),2)},G:function(){return c.getHours()},H:function(){return k(d.G(),2)},i:function(){return k(c.getMinutes(),2)},s:function(){return k(c.getSeconds(),2)},U:function(){return c.getTime()/1e3|0},I:function(){var a=d.Y(),b=(new Date(a,0,1)).getTimezoneOffset();b=Math.max(b,(new Date(a,6,1)).getTimezoneOffset());return 0+(c.getTimezoneOffset()<b)},O:function(){var a=c.getTimezoneOffset();return(a>0?"-":"+")+k(Math.abs(a/60*100),4)},P:function(){var a=d.O();return a.substr(0,3)+":"+a.substr(3,2)},Z:function(){return-c.getTimezoneOffset()*60}};var b={dateNow:function(a){return a?(new Date).getTime():new Date},dateFormat:function(a,b){var a=a||"";c=m(b);return a.replace(e,j)},timeAsWords:function(a){var b=Math.abs(a)/1e3,c=b/60,d=c/60,e=d/24,f=e/365;return b<45&&l("ss",b|0)||b<90&&l("m")||c<45&&l("mm",c|0)||c<90&&l("h")||d<24&&l("hh",d|0)||d<48&&l("d")||e<30&&l("dd",e|0)||e<60&&l("n")||e<350&&l("nn",e/30|0)||f<2&&l("y")||l("yy",f|0)},timeDiff:function(a,b){var c=m(a),d=m(b);return c.getTime()-d.getTime()},timeFromNow:function(a,c){var d=b.timeDiff(a,c),e=d<0?h.past:h.future;return e.replace(/%s/i,b.timeAsWords(d))},setTimeI18N:function(a){a.weekdays&&_.isArray(a.weekdays)&&a.weekdays.length==7&&(f=a.weekdays),a.months&&_.isArray(a.months)&&a.months.length==12&&(g=a.months),a.timeago&&_.extend(h,a.timeago),a.ordinal&&_.isFunction(a.ordinal)&&(i=a.ordinal)}};a._d=b,a._&&a._.mixin(b)})()